!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3"),require("webfontloader")):"function"==typeof define&&define.amd?define(["exports","d3","webfontloader"],e):e(t.startext=t.startext||{},t.d3,t.WebFont)}(this,function(t,e,n){"use strict";function i(t,e,n){var i=t.length;if(!(e>=i||0===n)){n=e+n>i?i-e:n;for(var r=i-n,a=e;a<r;++a)t[a]=t[a+n];t.length=r}}function r(t,e){if(null==e&&(e=t,t=0),t>e){var n=t;t=e,e=n}return t+(e-t)*Math.random()}function a(t){return t[Math.random()*t.length|0]}function o(t){F=t.containerDiv.classed("introchart",!0),M=t.myIntro,L=t.transitionSpeed,O=t.explosionStrength,T=t.pause,R=t.replay,B=t.fontFamily,E.background=t.background,E.backgroundColor=t.backgroundColor,E.srcBackgroundImage=t.backgroundImage;var e=new Image;e.src=E.srcBackgroundImage,E.backgroundImage=e}function s(t){o(t),n.load({google:{families:[B]},fontactive:function(){l(M[0])}})}function l(t){h(t),c(),g(t.defaultLine,t.punchLine)}function h(t){for(var e=F.append("div").attr("class","textbox"),n=0;n<t.length;n++)for(var i=e.append("div").attr("class","widthForIE h"+n).append("div").attr("class","header h"+n).append("h1").style("font-family",B).attr("class","trans"),r=t[n],a=0;a<r.length;a++)i.append("span").attr("class",n<t.length-1?"rotate":"burst color-"+a%5).text(r[a]);u()}function u(){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=F.select("div.textbox").node().getBoundingClientRect().height;e.select("div.textbox").style("padding-top",(t-n)/2+"px")}function c(){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=F.append("div").attr("class","paths").append("svg").attr("width",t).attr("height",n),r=F.node().getBoundingClientRect();F.selectAll("h1").each(function(t,n){var a=e.select(this).node().getBoundingClientRect(),o=0;e.select(this).selectAll("span").each(function(t){var n=e.select(this).node().getBoundingClientRect();o+=n.width});var s={};s.width=o,s.xStart=(r.width-o)/2,s.yStart=a.top+a.height/2-r.top;var l=i.append("path").attr("class","header hidden trans h"+n).attr("d",function(){return"M"+s.xStart+" "+s.yStart+" L"+(s.width+s.xStart)+" "+s.yStart}),h=l.node().getTotalLength()*L;C.push(h)})}function d(){var t=F.node().getBoundingClientRect();F.insert("div",".textbox").attr("class","stars").append("canvas").attr("id","view").attr("width",t.width).attr("height",t.height),E.texture=document.querySelector("#star-texture-white"),E.view=document.querySelector("#view"),A=new S(E),window.addEventListener("load",A.start()),window.focus()}function f(t){var e=t.getTotalLength();return function(n,i,r){return function(n){var i=t.getPointAtLength(n*e);return A.spawn(i.x,i.y),"translate(0,0)"}}}function g(t,n){d(),void 0===t&&(t=m),void 0===n&&(n=m);var i=C.concat(C),r=e.selectAll(".trans").data(i);!function(n){function i(t){if(h===u-1)o(t);else{var r=t.filter(function(t,e){return 0===e}),a=r.node().__data__,s=r.selectAll("span"),l=s.size();s.transition().duration(1e3).delay(function(t,e){return 1e3+e/l*a}).ease(e.easeLinear).style("opacity",1);var d=t.filter(function(t,e){return 1===e});d.transition().duration(function(t){return t}).delay(1e3).ease(e.easeLinear).attrTween("transform",f(d.node())).on("end",function(){h+=1,u>h&&(c=n.filter(function(t,e){return e%u===h}),i(c))})}}function r(t){if(h===u-1)o(t);else{var i=t.filter(function(t,e){return 0===e}).selectAll("span");i.style("transform","rotate(-0deg) scale(.001)").transition().duration(2e3).delay(function(t,e){return 200*e}).style("opacity",1).tween("transform",function(){var t=e.select(this),n=e.interpolateNumber(.001,1),i=e.interpolateNumber(-0,-720);return function(e){t.style("transform","rotate("+i(e)+"deg)scale("+n(e)+")")}}).on("end",function(t,e){e===i.size()-1&&(h+=1,u>h&&(c=n.filter(function(t,e){return e%u===h}),r(c)))})}}function a(t){if(h===u-1)o(t);else{var e=t.filter(function(t,e){return 0===e}).selectAll("span"),i=e.style("font-size");e.style("font-size","0px").transition().duration(2e3).delay(function(t,e){return 200*e}).style("opacity",1).style("font-size",i).on("end",function(t,i){i===e.size()-1&&(h+=1,u>h&&(c=n.filter(function(t,e){return e%u===h}),a(c)))})}}function o(t){setTimeout(function(){A.setActivate(!1),s(t)},1e3)}function s(t){E.texture=document.querySelector("#star-texture");var e=new S(E);window.addEventListener("load",e.start()),window.focus(),t.filter(function(t,e){return 0===e}).selectAll("span").transition().duration(0).style("opacity",1);for(var n=t.filter(function(t,e){return 1===e}).node(),i=n.getTotalLength(),r=0;r<1;r+=O){var a=n.getPointAtLength(r*i);e.spawn(a.x,a.y)}setTimeout(function(){e.setActivate(!1),(I+=1)>=M.length&&(I=0,!R)||(C=[],F.selectAll("*").remove(),l(M[I]))},T)}var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=n.size()/2,c=n.filter(function(t,e){return e%u===h});switch(t){case m:i(c);break;case b:r(c);break;case w:a(c);break;default:i(c)}}(r)}function p(t,n){function i(t){return t.each(function(){r.containerDiv=e.select(this),s(r)}),i}var r={};return r.replay=!0,r.explosionStrength=function(){return-1!==window.navigator.userAgent.indexOf("MSIE ")}()?.01:.002,r.pause=5e3,r.transitionSpeed=7,r.fontFamily="Indie Flower",r.background=v,r.backgroundColor="#111111",r.backgroundImage="https://ee2dev.github.io/startext/lib/nightSky.jpg",r.myIntro=t,i.background=function(t){return arguments.length?(r.background=t,i):r.background},i.backgroundColor=function(t){return arguments.length?(r.backgroundColor=t,i):r.backgroundColor},i.backgroundImage=function(t){return arguments.length?(r.backgroundImage=t,i):r.backgroundImage},i.fontFamily=function(t){return arguments.length?(r.fontFamily=t,i):r.fontFamily},i.explosionStrength=function(t){if(!arguments.length)return r.explosionStrength;t<0?t=0:t>1&&(t=1);var n=e.scalePow().domain([0,1]).range([1,0]);return r.explosionStrength=r.explosionStrength+n(t),i},i.pause=function(t){return arguments.length?(r.pause=t,i):r.pause},i.replay=function(t){return arguments.length?(r.replay=t,i):r.replay},i.transitionSpeed=function(t){if(!arguments.length)return r.transitionSpeed;t<0?t=0:t>1&&(t=1);var n=e.scaleLinear().domain([0,1]).range([20,1]);return r.transitionSpeed=n(t),i},n&&function(){i.background("COLOR"===t.background?v:y).backgroundColor(t.backgroundColor).backgroundImage(t.backgroundImage).fontFamily(t.fontFamily).explosionStrength(t.explosionStrength).transitionSpeed(t.transitionSpeed).pause(t.pause).replay(t.replay)}(),i}n="default"in n?n.default:n;var v=1,y=2,m=0,b=1,w=2;"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1;i<arguments.length;i++){var r=arguments[i];if(null!=r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}return n},writable:!0,configurable:!0}),console.clear();var x=2*Math.PI,k=function(){function t(t,e){this.texture=t,this.frame=e,this.alive=!1,this.width=e.width,this.height=e.height,this.originX=e.width/2,this.originY=e.height/2}return t.prototype.init=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var n=r(x),i=r(2,6);return this.x=t,this.y=e,this.alpha=1,this.alive=!0,this.theta=n,this.vx=Math.sin(n)*i,this.vy=Math.cos(n)*i,this.rotation=Math.atan2(this.vy,this.vx),this.drag=r(.82,.97),this.scale=r(.1,1),this.wander=r(.5,1),this.matrix={a:1,b:0,c:0,d:1,tx:0,ty:0},this},t.prototype.update=function(){var t=this.matrix;this.x+=this.vx,this.y+=this.vy,this.vx*=this.drag,this.vy*=this.drag,this.theta+=r(-.5,.5)*this.wander,this.vx+=.1*Math.sin(this.theta),this.vy+=.1*Math.cos(this.theta),this.rotation=Math.atan2(this.vy,this.vx),this.alpha*=.98,this.scale*=.985,this.alive=this.scale>.06&&this.alpha>.06;var e=Math.cos(this.rotation)*this.scale,n=Math.sin(this.rotation)*this.scale;return t.a=e,t.b=n,t.c=-n,t.d=e,t.tx=this.x-(this.originX*t.a+this.originY*t.c),t.ty=this.y-(this.originX*t.b+this.originY*t.d),this},t.prototype.draw=function(t){var e=this.matrix,n=this.frame;return t.globalAlpha=this.alpha,t.setTransform(e.a,e.b,e.c,e.d,e.tx,e.ty),t.drawImage(this.texture,n.x,n.y,n.width,n.height,0,0,this.width,this.height),this},t}(),S=function(){function t(t){var e=this;this.pool=[],this.particles=[],this.pointer={x:-9999,y:-9999},this.buffer=document.createElement("canvas"),this.bufferContext=this.buffer.getContext("2d"),this.supportsFilters=void 0!==this.bufferContext.filter,e.activate=!0,this.setActivate=function(t){e.activate=t},this.AnimationId,this.pointerMove=function(t){t.preventDefault();var n=t.targetTouches?t.targetTouches[0]:t;e.pointer.x=n.clientX,e.pointer.y=n.clientY;for(var i=0;i<r(2,7);i++)e.spawn(e.pointer.x,e.pointer.y)},this.resize=function(t){e.width=e.buffer.width=e.view.width,e.height=e.buffer.height=e.view.height},this.render=function(t){var n=e.context,r=e.particles,a=e.bufferContext;if(e.background===v)n.fillStyle=e.backgroundColor,n.fillRect(0,0,e.view.width,e.view.height);else if(e.background===y){var o=n.createPattern(e.backgroundImage,"repeat");n.fillStyle=o,n.fillRect(0,0,e.width,e.height)}a.globalAlpha=1,a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,e.view.width,e.view.height),a.globalCompositeOperation=e.blendMode;for(var s=0;s<r.length;s++){var l=r[s];l.alive?l.update():(e.pool.push(l),i(r,s,1))}for(var h=0,u=r;h<u.length;h++)l=u[h],l.draw(a);e.supportsFilters&&(e.useBlurFilter&&(n.filter="blur("+e.filterBlur+"px)"),n.drawImage(e.buffer,0,0),e.useContrastFilter&&(n.filter="drop-shadow(4px 4px 4px rgba(0,0,0,1)) contrast("+e.filterContrast+"%)")),n.drawImage(e.buffer,0,0),n.filter="none",e.activate?e.AnimationId=requestAnimationFrame(e.render):cancelAnimationFrame(e.AnimationId)},Object.assign(this,t),this.context=this.view.getContext("2d",{alpha:!1})}return t.prototype.spawn=function(t,e){var n;return n=this.particles.length>this.maxParticles?this.particles.shift():this.pool.length?this.pool.pop():new k(this.texture,a(this.frames)),n.init(t,e),this.particles.push(n),this},t.prototype.start=function(){return this.resize(),this.render(),this.view.style.visibility="visible",requestAnimationFrame(this.render),this},t}(),C=[],A=void 0,I=0,F=void 0,M=[],L=void 0,O=void 0,T=void 0,R=void 0,B=void 0,E={mouseListener:!1,frames:function(t,e,n){for(var i=[],r=0;r<t;r++)i.push({x:e*r,y:0,width:e,height:n});return i}(5,80,80),maxParticles:2e3,blendMode:"lighter",filterBlur:50,filterContrast:300,useBlurFilter:!0,useContrastFilter:!0};t.chart=p,t.COLOR=v,t.IMAGE=y,t.STARS=m,t.ROTATION=b,t.SCALE=w,Object.defineProperty(t,"__esModule",{value:!0})});